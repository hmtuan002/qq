<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tool Test B√†i thi PCCC - Admin</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, button, textarea {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: none;
            border-radius: 5px;
            box-sizing: border-box;
        }
        button {
            background: #ffb800;
            color: #000;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
            margin: 5px;
        }
        button:hover {
            background: #ff9900;
        }
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        .result {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }
        .hidden {
            display: none;
        }
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: rgba(255,255,255,0.1);
            margin-bottom: 20px;
        }
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            color: white;
            width: auto;
        }
        .tab button:hover {
            background-color: rgba(255,255,255,0.2);
        }
        .tab button.active {
            background-color: #ffb800;
            color: black;
        }
        .tabcontent {
            display: none;
            padding: 6px 12px;
            border-top: none;
        }
        .status-success {
            color: #4CAF50;
            font-weight: bold;
        }
        .status-error {
            color: #f44336;
            font-weight: bold;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Tool Test B√†i thi PCCC - Admin</h1>
        <p><strong>Quy·ªÅn h·∫°n:</strong> ƒê√£ ƒë∆∞·ª£c ch·ªß web cho ph√©p test</p>
        
        <div class="tab">
            <button class="tablinks active" onclick="openTab(event, 'CustomTest')">T√πy ch·ªânh k·∫øt qu·∫£</button>
            <button class="tablinks" onclick="openTab(event, 'RealSubmit')">G·ª≠i request th·ª±c t·∫ø</button>
            <button class="tablinks" onclick="openTab(event, 'ManualRequest')">Request th·ªß c√¥ng</button>
        </div>

        <!-- Tab 1: T√πy ch·ªânh k·∫øt qu·∫£ -->
        <div id="CustomTest" class="tabcontent" style="display: block;">
            <div class="form-group">
                <label for="score">ƒêi·ªÉm s·ªë mong mu·ªën (0-10):</label>
                <input type="number" id="score" min="0" max="10" value="8">
            </div>

            <div class="form-group">
                <label for="correctAnswers">S·ªë c√¢u ƒë√∫ng:</label>
                <input type="number" id="correctAnswers" min="0" max="10" value="8">
            </div>

            <div class="form-group">
                <label for="timeSpent">Th·ªùi gian l√†m b√†i (gi√¢y):</label>
                <input type="number" id="timeSpent" value="450">
            </div>

            <div class="form-group">
                <label for="prediction">D·ª± ƒëo√°n s·ªë ng∆∞·ªùi ƒë√∫ng to√†n b·ªô:</label>
                <input type="number" id="prediction" value="50">
            </div>

            <button onclick="generateCustomResult()">üöÄ T·∫°o k·∫øt qu·∫£ t√πy ch·ªânh</button>
        </div>

        <!-- Tab 2: G·ª≠i request th·ª±c t·∫ø -->
        <div id="RealSubmit" class="tabcontent">
            <div class="form-group">
                <label for="sessionCookie">Session Cookie (wordpress_logged_in_...):</label>
                <textarea id="sessionCookie" rows="3" placeholder="D√°n cookie ƒëƒÉng nh·∫≠p t·∫°i ƒë√¢y"></textarea>
            </div>

            <div class="form-group">
                <label for="customPayload">Payload t√πy ch·ªânh (n·∫øu c√≥):</label>
                <textarea id="customPayload" rows="6" placeholder="C√≥ th·ªÉ ch·ªânh s·ª≠a payload tr∆∞·ªõc khi g·ª≠i"></textarea>
            </div>

            <button onclick="submitRealRequest()" id="submitRealBtn">üì® G·ª≠i request th·ª±c t·∫ø ƒë·∫øn server</button>
            <button onclick="testConnection()" id="testBtn">üîç Test k·∫øt n·ªëi</button>
        </div>

        <!-- Tab 3: Request th·ªß c√¥ng -->
        <div id="ManualRequest" class="tabcontent">
            <div class="form-group">
                <label for="manualUrl">URL:</label>
                <input type="text" id="manualUrl" value="https://cuocthitracnghiem.hssvhue.com/tim-hieu-phap-luat-ve-phong-chay-chua-chay-va-cuu-nan-cuu-ho/">
            </div>
            
            <div class="form-group">
                <label for="manualHeaders">Headers:</label>
                <textarea id="manualHeaders" rows="8">Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7GSRHnSUAyNf2
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: vi,fr-FR;q=0.9,fr;q=0.8,en-US;q=0.7,en;q=0.6
Origin: https://cuocthitracnghiem.hssvhue.com
Referer: https://cuocthitracnghiem.hssvhue.com/tim-hieu-phap-luat-ve-phong-chay-chua-chay-va-cuu-nan-cuu-ho/</textarea>
            </div>

            <button onclick="sendManualRequest()">üîß G·ª≠i request th·ªß c√¥ng</button>
        </div>

        <!-- K·∫øt qu·∫£ -->
        <div id="result" class="result">
            <h3>üìä K·∫øt qu·∫£ b√†i thi:</h3>
            <p><strong>ƒêi·ªÉm s·ªë:</strong> <span id="displayScore">8</span>/10</p>
            <p><strong>S·ªë c√¢u ƒë√∫ng:</strong> <span id="displayCorrect">8</span>/10</p>
            <p><strong>Th·ªùi gian l√†m b√†i:</strong> <span id="displayTime">450</span> gi√¢y</p>
            <p><strong>D·ª± ƒëo√°n c·ªßa b·∫°n:</strong> <span id="displayPrediction">50</span> ng∆∞·ªùi ƒë√∫ng to√†n b·ªô</p>
            
            <h4>üìã Payload s·∫Ω g·ª≠i:</h4>
            <textarea id="payloadDisplay" rows="12" readonly></textarea>
            
            <div id="submitStatus"></div>
        </div>

        <div id="responseResult" class="result hidden">
            <h3>üì° Ph·∫£n h·ªìi t·ª´ server:</h3>
            <pre id="serverResponse"></pre>
        </div>
    </div>

    <script>
        // Danh s√°ch ID c√¢u h·ªèi m·∫´u
        const questionIds = [
            "195263", "195281", "195234", "195266", 
            "195246", "195194", "195261", "195289", 
            "195205", "195294"
        ];

        let currentPayload = '';

        function openTab(evt, tabName) {
            const tabcontent = document.getElementsByClassName("tabcontent");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            
            const tablinks = document.getElementsByClassName("tablinks");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        function generateCustomResult() {
            const score = parseInt(document.getElementById('score').value);
            const correctAnswers = parseInt(document.getElementById('correctAnswers').value);
            const timeSpent = parseInt(document.getElementById('timeSpent').value);
            const prediction = parseInt(document.getElementById('prediction').value);

            if (score < 0 || score > 10 || correctAnswers < 0 || correctAnswers > 10) {
                alert('Vui l√≤ng nh·∫≠p gi√° tr·ªã h·ª£p l·ªá (0-10)');
                return;
            }

            document.getElementById('displayScore').textContent = score;
            document.getElementById('displayCorrect').textContent = correctAnswers;
            document.getElementById('displayTime').textContent = timeSpent;
            document.getElementById('displayPrediction').textContent = prediction;

            currentPayload = generatePayload(score, correctAnswers, timeSpent, prediction);
            document.getElementById('payloadDisplay').value = currentPayload;
            document.getElementById('customPayload').value = currentPayload;

            document.getElementById('result').style.display = 'block';
        }

        function generatePayload(score, correctAnswers, timeSpent, prediction) {
            const questionString = questionIds.join('|');
            const answers = [];
            
            for (let i = 0; i < 10; i++) {
                if (i < correctAnswers) {
                    answers.push(String.fromCharCode(97 + Math.floor(Math.random() * 4)));
                } else {
                    answers.push('0');
                }
            }

            const formData = new FormData();
            formData.append('input_35.0', questionString);
            formData.append('input_35.1', '0');
            for (let i = 2; i <= 11; i++) {
                formData.append(`input_35.${i}`, answers[i-2] || '0');
            }
            formData.append('input_37', timeSpent.toString());
            formData.append('input_38', answers.join(''));
            formData.append('input_39', questionString);
            formData.append('input_27', prediction.toString());
            formData.append('gform_ajax', 'form_id=11&title=&description=1&tabindex=0&theme=gravity-theme&styles=[]&hash=86542dc1de8c61b962fddb472a003fa0');
            formData.append('gform_submission_method', 'iframe');
            formData.append('gform_theme', 'gravity-theme');
            formData.append('gform_style_settings', '[]');
            formData.append('is_submit_11', '1');
            formData.append('gform_submit', '11');
            formData.append('gform_unique_id', '');
            formData.append('state_11', 'WyJbXSIsImNiNzViZmI1NjQ4ZmU4MDgzMWM2Y2YwMDAzMzg2ZTEzIl0=');
            formData.append('gform_target_page_number_11', '2');
            formData.append('gform_source_page_number_11', '1');
            formData.append('gform_field_values', '');

            let payloadString = '';
            for (const [key, value] of formData.entries()) {
                payloadString += `${key}=${encodeURIComponent(value)}\n`;
            }

            return payloadString;
        }

        async function submitRealRequest() {
            const submitBtn = document.getElementById('submitRealBtn');
            const statusDiv = document.getElementById('submitStatus');
            const responseDiv = document.getElementById('responseResult');
            const serverResponse = document.getElementById('serverResponse');

            submitBtn.disabled = true;
            submitBtn.innerHTML = '<div class="loading"></div> ƒêang g·ª≠i...';
            statusDiv.innerHTML = '<p>üîÑ ƒêang k·∫øt n·ªëi ƒë·∫øn server...</p>';

            try {
                const sessionCookie = document.getElementById('sessionCookie').value;
                const customPayload = document.getElementById('customPayload').value || currentPayload;

                if (!sessionCookie) {
                    throw new Error('Vui l√≤ng nh·∫≠p session cookie');
                }

                // T·∫°o FormData t·ª´ payload
                const formData = new FormData();
                const lines = customPayload.split('\n');
                
                for (const line of lines) {
                    if (line.trim()) {
                        const [key, value] = line.split('=');
                        if (key && value) {
                            formData.append(key.trim(), decodeURIComponent(value.trim()));
                        }
                    }
                }

                const response = await fetch('https://cuocthitracnghiem.hssvhue.com/tim-hieu-phap-luat-ve-phong-chay-chua-chay-va-cuu-nan-cuu-ho/', {
                    method: 'POST',
                    headers: {
                        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
                        'Accept-Language': 'vi,fr-FR;q=0.9,fr;q=0.8,en-US;q=0.7,en;q=0.6',
                        'Content-Type': 'multipart/form-data',
                        'Origin': 'https://cuocthitracnghiem.hssvhue.com',
                        'Referer': 'https://cuocthitracnghiem.hssvhue.com/tim-hieu-phap-luat-ve-phong-chay-chua-chay-va-cuu-nan-cuu-ho/',
                        'Cookie': `wordpress_test_cookie=WP%20Cookie%20check; wp_lang=vi; ${sessionCookie}`
                    },
                    body: formData,
                    credentials: 'include'
                });

                const responseText = await response.text();
                
                statusDiv.innerHTML = `<p class="status-success">‚úÖ Request g·ª≠i th√†nh c√¥ng!</p>
                                     <p>Status: ${response.status} ${response.statusText}</p>`;
                
                serverResponse.textContent = responseText;
                responseDiv.classList.remove('hidden');

                console.log('Server response:', responseText);

            } catch (error) {
                statusDiv.innerHTML = `<p class="status-error">‚ùå L·ªói: ${error.message}</p>`;
                console.error('Error:', error);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'üì® G·ª≠i request th·ª±c t·∫ø ƒë·∫øn server';
            }
        }

        async function testConnection() {
            const testBtn = document.getElementById('testBtn');
            const statusDiv = document.getElementById('submitStatus');

            testBtn.disabled = true;
            testBtn.innerHTML = '<div class="loading"></div> ƒêang test...';

            try {
                const response = await fetch('https://cuocthitracnghiem.hssvhue.com/tim-hieu-phap-luat-ve-phong-chay-chua-chay-va-cuu-nan-cuu-ho/', {
                    method: 'HEAD',
                    mode: 'no-cors'
                });

                statusDiv.innerHTML = '<p class="status-success">‚úÖ K·∫øt n·ªëi ƒë·∫øn server th√†nh c√¥ng!</p>';
            } catch (error) {
                statusDiv.innerHTML = `<p class="status-error">‚ùå Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server: ${error.message}</p>`;
            } finally {
                testBtn.disabled = false;
                testBtn.textContent = 'üîç Test k·∫øt n·ªëi';
            }
        }

        function sendManualRequest() {
            alert('T√≠nh nƒÉng request th·ªß c√¥ng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn...');
        }

        // T·ª± ƒë·ªông t·∫°o k·∫øt qu·∫£ m·∫´u khi load trang
        window.onload = function() {
            generateCustomResult();
        }
    </script>
</body>
</html>